<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
<!--   Replace the content tag with appropriate information -->
  <meta name="description" content="Project webpage for Summer'25 CS7641 ML Group Project">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="https://athlon76.github.io/MLProject_Summer25/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Academic Project Page</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">
              <p>Pathway Feature Driven</p>
              <p>Cancer Metastasis Prediction</p>
            </h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="abn33@gatech.edu">Abdulrhman Ba Nabila</a><sup>*</sup>,</span>
                <span class="author-block">
                  <a href="jhong392@gatech.edu">Jihoon Hong</a><sup>*</sup>,</span>
                  <span class="author-block">
                    <a href="kjeong36@gatech.edu">Kiyoung Jeong</a><sup>*</sup>,</span>
                    <span class="author-block">
                      <a href="ikang31@gatech.edu">Innie Y. Kang</a><sup>*</sup>,</span>
                      <span class="author-block">
                      <a href="hmun7@gatech.edu">Huyju Mun</a><sup>*</sup>,</span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Georgia Institute of Technology<br><a href="https://mahdi-roozbahani.github.io/CS46417641-summer2025/">CS7641 Machine Learning (Summer '25)</a></span>
                    <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
                  </div>

                <div class="column has-text-centered">
                    <div class="gantt-links">
                      <span class="link-block">
                        <a href="https://docs.google.com/spreadsheets/d/1waDtMsP7N2mdSJ-1rsT3LUz_CO1o-ujY/edit?usp=sharing&ouid=105249191840393572714&rtpof=true&sd=true" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span>GANTT</span>
                      </a>
                    </span>

            <!--
                  <div class="column has-text-centered">
                    <div class="publication-links">
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/<ARXIV PAPER ID>.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>

                  <span class="link-block">
                    <a href="https://github.com/YOUR REPO HERE" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="https://arxiv.org/abs/<ARXIV PAPER ID>" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        -->

            
        </div>
      </div>
    </div>
  </div>
</section>


<!--
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        
        <source src="static/videos/banner_video.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section>
-->
<!-- Proposal-->
        
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">

        <!-- ===================================================== -->
        <!--  INTRODUCTION / BACKGROUND                            -->
        <!-- ===================================================== -->
        <h2 class="title is-3">Midterm Report</h2>

        <div class="content has-text-justified">

          <!-- ----------------- LITERATURE REVIEW ---------------- -->
          <h3>Introduction/Background</h3>
          <h4>Literature Review</h4>
          <p>
            With advances in machine learning and deep learning, metastasis prediction across cancers has gained traction using multi-omics, clinical, and imaging data.
            Botlagunta <em>et&nbsp;al.</em> [1] developed a decision-tree web application leveraging blood profiles and electronic medical records for metastatic breast-cancer prediction.
            Yagin <em>et&nbsp;al.</em> [2] applied explainable artificial-intelligence techniques with SHAP values to highlight key biomarkers, while Duan <em>et&nbsp;al.</em> [3] used transcriptomic data and weighted-gene-co-expression-network analysis for distant-metastasis prediction via random-forest models.
            Talebi <em>et&nbsp;al.</em> [5] focused on gastrointestinal cancers, integrating demographic and clinical variables.
            Reviews by Petinrin [6] and Albaradei [7] noted the strength of omics-based models but emphasised challenges such as data heterogeneity and interpretability.
            Gao <em>et&nbsp;al.</em> [8] linked genomic alterations to metastasis patterns.
          </p>

          <!-- ------------- INITIAL DATASET DESCRIPTION ----------- -->
          <h4>Initial Dataset Description</h4>
          <p>
            <a href="https://www.cbioportal.org/study/summary?id=msk_met_2021">
              <strong>MSK-MET 2021 Cancer Dataset (Patient Data, Memorial Sloan Kettering)</strong>
            </a>
            [9] comprises 25 775 metastatic tumor samples with somatic mutations across 341 cancer-related genes, along with annotations such as tumor origin and metastasis site.
            Key features include <code>Hugo_Symbol</code> (gene), <code>Tumor_Sample_Barcode</code> (sample ID), and clinical variables.
            The output labels are metastasis sites such as bone, brain, and liver.
          </p>
          <p>
            <a href="https://www.gsea-msigdb.org/gsea/msigdb/human/genesets.jsp?collection=3CA">
              <strong>MSigDB Curated Cancer Cell Atlas Gene Sets by Gavish <em>et&nbsp;al.</em> (Pathway Gene Data)</strong>
            </a>
            provide 148 curated gene sets (each containing 50 genes) relevant to tumor states.
            These serve as the basis for our pathway-level representation: mutated genes from MSK-MET are mapped to these pathways to generate feature vectors.
          </p>

          <!-- ------------- ADDITIONAL DATASET DESCRIPTION -------- -->
          <h4>Additional Dataset Description</h4>
          <p>
            <a href="https://www.genome.jp/kegg/pathway.html">
              <strong>KEGG PATHWAY Database (Pathway Gene Data)</strong>
            </a>
            offers 35 478 gene sets relevant to metabolism, genetic-information processing, environmental-information processing, cellular processes, organismal systems, human diseases, and drug development.
            Mutated genes from MSK-MET are mapped to these pathways to generate pathway-based feature vectors.
          </p>
          <p>
            <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE278688">
              <strong>GSE278688 Single-cell RNA-seq Dataset (GEO)</strong>
            </a>
            provides transcriptomic profiles of immune cells derived from human brain metastases.
            The dataset includes gene-expression matrices for 83 606 single cells from 29 samples, covering multiple immune-cell types such as CD8 T cells, myeloid cells, and B cells.
            Each cell is annotated with metadata, including patient ID and manually curated cell-type labels.
            This dataset was used as an alternative when the original mutation-derived dataset proved too sparse and imbalanced for effective modeling.
          </p>

          <!-- ===================================================== -->
          <!--  PROBLEM DEFINITION                                   -->
          <!-- ===================================================== -->
          <h3>Problem Definition</h3>

          <h4>Initial Problem</h4>
          <p>
            Current cancer diagnostics (biopsies) provide limited insight into tumor evolution and often miss critical events that drive metastasis [11].
            Because tumors develop heterogeneously and rapidly—undergoing dynamic genetic mutations, metabolic changes, and invasive behaviors—this approach can overlook critical biological alterations, complicating accurate diagnosis and personalized therapy [12].
            The task is a multi-label classification problem: predict where a tumor will metastasize.
            Each input sample is represented by a feature vector of pathway scores, and the model outputs labels corresponding to metastasis sites.
            Unsupervised clustering is required to reduce feature dimensionality and uncover latent structure in the data.
          </p>

          <h4>Revised Problem</h4>
          <p>
            Unfortunately, the proposed approach revealed several biological and computational limitations.
            The mutation-derived features were extremely sparse, and the metastatic site labels were often missing or ambiguous, making supervised learning unreliable and potentially misleading. 
            This challenge is consistent with prior observations that metastasis events are frequently under-documented or poorly labeled in clinical datasets, limiting the utility of standard classification methods [18]. 
            To overcome these limitations, we shifted our focus from predicting metastatic sites to characterizing the latent biological structure of tumor profiles across different data modalities.
            By comparing clustering performance on mutation-derived features (MSK-MET) and gene expression profiles (scRNA-seq), we evaluate how different data types capture tumor heterogeneity, cellular identity, and potentially metastatic potential. 
            This enables biologically meaningful insights into which molecular profiles are more informative for downstream tasks even in the absence of reliable ground-truth labels.
          </p>

          <h4>Motivation</h4>
          <p>
            To address variability across patients and improve reproducibility, analysis of metastatic sites should extend beyond local assessments to include multiple destinations [13, 14].
            This broader perspective helps reduce unnecessary medical expenses and the burden of exhaustive biopsies caused by uncertain tumor tropism [15].
            By integrating multi-omics data—including genetic, epigenetic, and metastatic-site profiles—we aim to achieve more precise tumor classification and effective therapeutic strategies [16, 17].
          </p>

          <h4>Revised Motivation</h4>
          <p>
            Our original motivation centered on improving metastasis prediction through biologically informed, pathway-level features.
            However, poor label quality and sparse mutation profiles limited our ability to train meaningful supervised models [18].
            As a result, we turned to unsupervised analysis not as a replacement, but as a means to evaluate which data representations (mutation-based or expression-based) carry stronger biological signal.
            This shift reflects the practical challenges of working with real-world clinical data, where missingness and noise often require alternative strategies to uncover actionable insights.
          </p>

          <!-- ===================================================== -->
          <!--  METHODS                                             -->
          <!-- ===================================================== -->
          <h3>Methods</h3>

          <h4>Proposed Approach</h4>
          <ul>
            <li><strong>Pre-processing:</strong> After standard data cleaning and one-hot encoding, we convert mutated genes into pathway scores (e.g., via ssGSEA). This yields a patient-by-pathway feature matrix..</li>
            <li><strong>Unsupervised Learning:</strong> Autoencoders (AE) or Variational Autoencoders (VAE) are used to reduce dimensionality. We apply clustering algorithms such as K-Means or GMM to enforce structure and train cluster-aware AEs, extracting embeddings that better capture metastasis profiles. </li>
            <li><strong>Supervised Learning:</strong> The learned embeddings feed into multi-label classifiers to predict metastasis sites. Comparisons will be made with models trained on full features (e.g., XG-Boost, logistic regression) for benchmarking.</li>
          </ul>

          <h4>Revised Approach</h4>
          <ul>
            <li><strong>Label Processing:</strong> Many samples were missing valid metastatic-site labels—either marked as <code>NaN</code>, <code>False</code>, or <code>unspecified</code>. These were consolidated under a “Non-metastatic” category. Additionally, labels were grouped by organ system to help coarsen the label space and assist later visualization. However, this grouping was only used during UMAP
visualization and not for supervised training.</li>
            <li><strong>Dimensionality Reduction and Clustering:</strong> PCA was applied to reduce the feature dimensionality, followed by UMAP to project data into 2D space for visualization. We tested clustering methods including KMeans, DBSCAN, and GMM, and evaluated them using Adjusted Rand Index (ARI) and Silhouette Score. Clustering performance was poor across all metrics, indicating lack of biological signal in the features.</li>
            <li><strong>Supervised Classification:</strong> Due to the class imbalance and multi-label nature of the dataset, we trained a series of one-vs-one (OvO) binary classifiers using both Random Forest and XGBoost. Each classifier was trained to distinguish between two metastatic sites using the PCA-reduced feature space. This approach was selected to reduce the effect of class imbalance and improve per-class resolution, though overall classification performance remained weak due to the noisy feature representation.</li>
          </ul>

          <h4>Pivoted Approach: scRNA-seq-based Feature Embedding and Clustering</h4>
          <p>
            Due to the limitations of the original MSK-MET mutation-derived dataset, we pivoted to a new dataset with more robust and continuous features: a single-cell RNA-sequencing dataset from GEO (accession <strong>GSE278688</strong>). This dataset provides gene expression matrices with accompanying cell
type labels.
          </p>
          <ul>
            <li><strong>Pre-processing and PCA:</strong>  Raw expression matrices and metadata were processed using the Seurat pipeline in R, which included filtering low-quality cells, normalization, log-scaling, and dimensionality reduction via PCA. Briefly, we calculated the percentage of mitochondrial gene expression for each cell using the <strong>PercentageFeatureSet()</strong> function with the pattern <strong>^MT-</strong>, which captures mitochondrial genes. We then filtered out low-quality cells by subsetting for those with more than 200 and fewer than 2,500 detected genes (<strong>nFeature_RNA</strong>), and with less than 5\% mitochondrial content (<strong>percent.mt</strong>).
            Normalization was performed using <strong>NormalizeData()</strong>, which applies a log-normalization method to standardize expression levels across cells and account for differences in sequencing depth.
            Principal Component Analysis (PCA) was conducted on highly variable genes identified using <strong>VariableFeatures()</strong>. PCA was run via <strong>RunPCA()</strong>, and the results were visualized using <strong>DimPlot()</strong>strong> with <strong>reduction = "pca"</strong>strong>. The resulting PCA embeddings (50 dimensions per cell) were exported for downstream analysis.
            
            </li>
            <li><strong>Unsupervised Clustering:</strong> In Python, we applied UMAP to project the 50-dimensional PCA embeddings into 2D space. We tested clustering using KMeans, DBSCAN, and GMM, and evaluated their performance using Adjusted Rand Index (ARI), Silhouette Score, and Davies-Bouldin Index against known cell type labels.</li>
            <li><strong>Supervised Classification:</strong> Using cell type labels as ground truth, we trained both Random Forest and XGBoost classifiers to test how well these PCA-reduced embeddings could distinguish between cell types. Cross-validation and macro F1-scores were used for evaluation.</li>
          </ul>

          <p>
              The filtered dataset used for modeling contained 72,653 single cells, each annotated with a unique cell barcode and a manually curated cluster label corresponding to immune cell subtypes such as Immune Cell, Fibroblast, or Mast Cell.
          </p>

          <h4>Model Implementation Details</h4>

          <h5>Dimensionality Reduction (UMAP)</h5>
          <p>UMAP was applied to the 50-dimensional PCA embeddings with the following parameters:</p>
          <ul>
            <li><code>n_neighbors = 30;</code></li>
            <li><code>min_dist = 0.3;</code></li>
            <li><code>metric = "cosine";</code></li>
            <li><code>n_components = 2;</code></li>
            <li><code>random_state = 42</code></li>
          </ul>
          <h5>Fully Connected Neural Network (2 FC Layers)</h5>
          <ul>
            <li><code>hidden_layer_sizes</code>: (50, 32)</li>
            <li><code>activation</code>: 'relu'</li>
            <li><code>solver</code>: 'adam'</li>
            <li><code>learning_rate_init</code>: 0.001</li>
            <li><code>learning_rate</code>: 'constant'</li>
            <li><code>alpha</code>: 0.0001</li>
            <li><code>batch_size</code>: 128</li>
            <li><code>max_iter</code>: 50</li>
            <li><code>early_stopping</code>: False</li>
            <li><code>shuffle</code>: True</li>
            <li><code>random_state</code>: 42</li>
          </ul>
          <h5>Random Forest (RF)</h5>
          <ul>
            <li><code>n_estimators</code>: 100</li>
            <li><code>criterion</code>: 'gini'</li>
            <li><code>max_depth</code>: None</li>
            <li><code>min_samples_split</code>: 2</li>
            <li><code>min_samples_leaf</code>: 1</li>
            <li><code>max_features</code>: 'sqrt'</li>
            <li><code>bootstrap</code>: True</li>
            <li><code>oob_score</code>: False</li>
            <li><code>random_state</code>: 42</li>
          </ul>

          <h5>XGBoost (XGB)</h5>
          <ul>
            <li><code>n_estimators</code>: 300</li>
            <li><code>max_depth</code>: 6</li>
            <li><code>learning_rate</code>: 0.05</li>
            <li><code>subsample</code>: 0.8</li>
            <li><code>colsample_bytree</code>: 0.8</li>
            <li><code>objective</code>: 'multi:softprob'</li>
            <li><code>random_state</code>: 42</li>
          </ul>
          <!-- ===================================================== -->
          <!--  RESULTS AND DISCUSSION                               -->
          <!-- ===================================================== -->
          <h3>Results and Discussion</h3>

          <h4>Proposed Analysis</h4>
          <ul>
            <li><strong>Clustering Metrics:</strong> Silhouette Score, purity, and normalized-cut metrics are used to evaluate clustering and guide AE training: <code>L<sub>total</sub>&nbsp;=&nbsp;L<sub>recon</sub>&nbsp;+&nbsp;λ&nbsp;L<sub>cluster</sub></code></li>
            <li><strong>Evaluation:</strong> Multi-label classification is assessed using Hamming Loss, micro/macro F1-Scores, and Precision@k. Results from pre-trained AE models are compared with baseline models using raw features.</li>
            <li><strong>Expected Outcome:</strong> By enforcing biologically informed latent structure, we aim for improved performance over baseline models. For single-label metastasis prediction, we anticipate cluster-driven models achieving accuracy greater than 0.8. Multi-label performance is expected to remain competitive, especially for primary site prediction.</li>
          </ul>

          <h4>Initial Challenges</h4>
          <p>
            Our initial dataset was constructed by integrating two sources: clinical gene mutation data from <strong>MSK-MET 2021 Cancer Dataset</strong> and pathway annotations from <strong>MSigDB Cancer Cell Atlas Gene Sets</strong> and <strong>KEGG PATHWAY Database</strong>. Each sample's mutated genes were mapped to 35,626 curated gene sets to produce binary pathway activation vectors. However, this mapping process revealed critical issues.
          </p>
          <ul>
            <li><strong>Label sparsity:</strong> Out of 2,151 patient samples, 1,420 (66%) had missing, false, or “unspecified” metastatic site labels. This significantly limited usable training data for supervised tasks.</li>
            <li><strong>Feature sparsity:</strong> Although each sample could have up to 35,626 pathway features based on our methods, most (n=8,757) had fewer than 10 non-zero values. Because this is mostly non-informative data, the model could not be trained effectively. This resulted in overfitting and high noise.</li>
            <li><strong>Class imbalance:</strong> The label distribution was highly skewed. Out of the many metastatic sites, only a few sites dominated: lymph (n=319), bone (n=208), and liver (n=91) while others had only 1–3 samples, which made it hard to balance.</li>
          </ul>

          <!--  UNSUPERVISED LEARNING PERFORMANCE FIGURES -->
          <h4>Unsupervised Learning and Clustering Performance</h4>
          <p>
            To understand the intrinsic structure of the data, we performed dimensionality reduction (PCA followed by UMAP) and applied clustering algorithms. UMAP visualization showed visually separated clusters, but these did not correlate with either metastatic site or organ system groupings. In short, clustering failed to align meaningfully with known metastasis labels:       
          </p>
          <figure>
            <img src="static/images/Kmeans_cluster_nonmetastatic_vs_all.png" alt="K-Means clustering: Non-metastatic vs All">
            <img src="static/images/Kmeans_density_nonmetastatic_vs_all.png" alt="K-Means density: Non-metastatic vs All">
            <figcaption>K-Means: ARI = 0.004, Silhouette = 0.89 – While the clusters appeared internally tight, they did not align well with known metastasis site labels.</figcaption>
          </figure>
          <figure>
            <img src="static/images/GMM_cluster_nonmetastatic_vs_all.png" alt="GMM clustering: Non-metastatic vs All">
            <img src="static/images/GMM_density_nonmetastatic_vs_all.png" alt="GMM density: Non-metastatic vs All">
            <figcaption>GMM collapsed into a single cluster in one case (ARI = 1.0) or failed to separate classes (ARI = 0). This indicated poor mode separation and possible convergence failure due to the flatness of the feature space.</figcaption>
          </figure>
          <figure>
            <img src="static/images/DBSCAN_density_nonmetastatic_vs_all.png" alt="DBSCAN density: Non-metastatic vs All">
            <figcaption>DBSCAN: ARI = 0.064, Silhouette = −0.132 – The negative silhouette score confirmed poor clustering quality and cohesion.</figcaption>
          </figure>

          <!--  SUPERVISED LEARNING PERFORMANCE FIGURES -->
          <h4>Supervised Learning Performance</h4>
          <p>
            We trained both Random Forest and XGBoost classifiers under a One-vs-One (OvO) strategy on the PCA-reduced features. Although OvO was chosen to mitigate class imbalance and isolate signal between class pairs, predictive performance remained poor. Most classifiers failed to outperform random guessing, likely due to the high sparsity and noise of the input data, along with weak signal across most metastatic site labels.</br>
            Below are UMAP projections of OvO comparisons: Non-Metastatic vs Canonical, Digestive, Endocrine, Lymphatic/Immune, Nervous, Reproductive, Respiratory, Skeletal, and Urinary.
          </p>
          <div class="columns is-multiline is-mobile">
            <div class="column is-one-third"><img src="static/images/UMAP_canonical.png"     alt="UMAP canonical"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_digestive.png"     alt="UMAP digestive"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_endocrine.png"     alt="UMAP endocrine"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_lymph.png"         alt="UMAP lymph"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_nervous.png"       alt="UMAP nervous"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_reproductive.png"  alt="UMAP reproductive"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_respiratory.png"   alt="UMAP respiratory"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_skeletal.png"      alt="UMAP skeletal"></div>
            <div class="column is-one-third"><img src="static/images/UMAP_urinary.png"       alt="UMAP urinary"></div>
          </div>

          <!--  TRANSITION TO SCRNA-SEQ -->
          <h4>Transition to scRNA-seq Dataset</h4>
          <p>
            The limitations of the MSK-MET mutation-based feature space prompted a pivot to a more robust and information-rich dataset: GSE278688, a single-cell RNA-seq dataset. This provided a more balanced label distribution (e.g., across cell types), continuous expression-derived features (in contrast to sparse binary vectors), and improved intrinsic clustering structure, as revealed by unsupervised methods.
          </p>
          <p>
            <strong>Clustering Results</strong>: Using PCA embeddings (50 components), UMAP revealed distinct groupings of cells by type. KMeans and DBSCAN produced clusters with much stronger alignment to the known cell type labels (as measured by ARI and silhouette scores), compared to the mutation-derived data. This supports the idea that transcriptional states provide more discriminative information for unsupervised learning.
          </p>
          <table class="table is-fullwidth is-striped">
            <caption>Clustering performance metrics on PCA-reduced scRNA-seq embeddings</caption>
            <thead>
              <tr><th>Method</th><th>ARI</th><th>Silhouette</th><th>Calinski-Harabasz</th><th>Davies–Bouldin</th></tr>
            </thead>
            <tbody>
              <tr><td>K-Means</td><td>0.39</td><td>0.55</td><td>122 409.9</td><td>0.69</td></tr>
              <tr><td>GMM</td>    <td>0.38</td><td>0.55</td><td>120 383.4</td><td>0.69</td></tr>
              <tr><td>DBSCAN</td> <td>0.22</td><td>0.02</td><td>10 594.6</td><td>0.58</td></tr>
            </tbody>
          </table>

          <figure>
            <img src="static/images/pca_embedding_scrnaseq.png"           alt="PCA embedding scRNA-seq">
            <img src="static/images/UMAP_PCA_reduced_scrnaseq.png"        alt="UMAP PCA scRNA-seq">
            <figcaption>Up: PCA embedding of the scRNA-seq dataset across 72 653 cells. Down: UMAP projection of PCA-reduced scRNA-seq data annotated with curated cell type labels: Immune, endothelial, fibroblast, and mast cells form well-separated clusters, validating the biological structure. </figcaption>
          </figure>
          <figure>
            <img src="static/images/Kmeans_cluster_scrnaseq.png"          alt="K-Means clustering scRNA-seq">
            <figcaption>KMeans clustering with (<em>k</em> = 5) on PCA-reduced scRNA-seq embeddings. Tight clusters are formed, though biological interpretability is limited without labels.</figcaption>
          </figure>
          <figure>
            <img src="static/images/GMM_cluster_scrnaseq.png"             alt="GMM clustering scRNA-seq">
            <img src="static/images/GMM_density_scrnaseq.png"             alt="GMM density scRNA-seq">
            <figcaption>Up: GMM clustering applied to PCA-reduced scRNA-seq embeddings. Five broad clusters emerge, capturing high-level transcriptional states. Down: GMM density contours show the learned Gaussian distributions. Some overlap exists, but major clusters remain well-separated.</figcaption>
          </figure>
          <figure>
            <img src="static/images/DBSCAN_cluster_scrnaseq.png"          alt="DBSCAN clustering scRNA-seq">
            <figcaption>DBSCAN clustering on PCA-reduced scRNA-seq embeddings. Distinct clusters emerge,
though sensitivity to noise is evident with the chosen parameters (ϵ = 0.4, <em>min_samples</em> = 40).</figcaption>
          </figure>

          <h4>Classification Results</h4>
          <p>
            <strong>Classification Results</strong>: Supervised classification using Random Forest and XGBoost on the PCA features yielded macro F1 scores significantly higher than those from the mutation-based models. This suggests that scRNA-seq-derived embeddings are better suited for both class separation
and predictive modeling.
          </p>
          <table class="table is-narrow">
            <thead>
              <tr><th>Model</th><th>Precision</th><th>Recall</th><th>F1-Score</th><th>Accuracy</th></tr>
            </thead>
            <tbody>
              <tr><td>Random Forest</td><td>0.99</td><td>0.98</td><td>0.99</td><td>0.983</td></tr>
              <tr><td>XGBoost</td>      <td>0.99</td><td>0.99</td><td>0.99</td><td>0.992</td></tr>
              <tr><td>2 FC Layers</td>  <td>0.99</td><td>0.99</td><td>0.984</td><td>0.990</td></tr>
            </tbody>
          </table>
          <figure>
            <img src="static/images/Training_accuracy_and_loss.png" alt="Training accuracy and loss">
            <figcaption>Training accuracy and loss over 50 epochs. Accuracy (blue, left axis) steadily increases and saturates near 1.0, while loss (red, right axis) decreases exponentially, indicating effective model convergence during training.</figcaption>
          </figure>

          <h4>Initial Conclusion</h4>
          <p>
            This pivot validated the importance of dataset selection and representation, particularly in domains where feature sparsity and label imbalance fundamentally limit model performance. While the original mutation-derived dataset offered a pathway-informed view of metastatic tropism, its extreme sparsity and label imbalance ultimately made effective modeling infeasible. In contrast, the scRNA-seq dataset enabled us to extract biologically meaningful structure and significantly improve both clustering and classification outcomes. Moving forward, we plan to refine the embeddings further, explore transfer learning from cell type to metastasis prediction, and expand our benchmarking against existing models.
          </p>
          <table border="1" cellspacing="0" cellpadding="6">
            <caption><strong>Comparison of Clustering Performance Across Datasets</strong></caption>
            <thead>
              <tr>
                <th rowspan="2">Algorithm</th>
                <th colspan="2">MSK-MET</th>
                <th colspan="2">scRNA-seq</th>
              </tr>
              <tr>
                <th>ARI</th>
                <th>Silhouette</th>
                <th>ARI</th>
                <th>Silhouette</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>KMeans</td>
                <td>0.004</td>
                <td>0.89</td>
                <td>0.39</td>
                <td>0.55</td>
              </tr>
              <tr>
                <td>GMM</td>
                <td>0.000 / 1.000<sup>*</sup></td>
                <td>--</td>
                <td>0.38</td>
                <td>0.55</td>
              </tr>
              <tr>
                <td>DBSCAN</td>
                <td>0.064</td>
                <td>-0.132</td>
                <td>0.22</td>
                <td>0.02</td>
              </tr>
            </tbody>
          </table>
          
          <p><small><sup>*</sup>GMM ARI for MSK-MET was 1.0 when all samples collapsed into a single cluster (pathological case), and 0.0 in a two-class setting. Silhouette Score was not computed due to lack of cluster diversity.</small></p>

          <h4>Next Steps</h4>
          <p>
            Given the high classification performance across models (Random Forest, XGBoost, and two fully connected layers), we aim to further validate and interpret the results through the following steps. First, we will refine the training pipeline by implementing a three-way data split with proportions of 64% for training, 16% for validation, and 20% for testing. Additionally, we will incorporate 5-fold cross-validation to assess the robustness and generalizability of each model and reduce the risk of overfitting. </br>
            To enhance biological interpretability—particularly in the context of brain cancer metasta-
sis—we will move beyond reliance on canonical markers to identify cell clusters. Specifically, we plan to investigate feature importance using tree-based models (Random Forest and XGBoost) in conjunction with SHAP (SHapley Additive exPlanations) analysis. This approach will enable us not only to rank predictive features but also to understand the directionality and contribution of each feature in determining cell identity. </br>
            Furthermore, we plan to incorporate <strong>Variational Autoencoders (VAEs)</strong> to capture latent representations of the gene expression profiles. By learning a compressed, probabilistic embedding of the transcriptomic landscape, VAEs can uncover underlying biological structure and heterogeneity among cells. We will compare the latent space learned by VAEs with that derived from PCA or UMAP to assess its utility for clustering and classification, as well as its potential to improve model interpretability and performance in downstream tasks.
          </p>
          
          <!-- ===================================================== -->
          <!--  REFERENCES                                           -->
          <!-- ===================================================== -->
          <h3>References</h3>
          <ol>
            <li>Madhavi Botlagunta, Madhuri D. Botlagunta, Madhu B. Myneni, Devi Lakshmi, Anusha Nayyar, Joga Singh Gullapalli, and Mohammed Atef Shah, “Classification and diagnostic prediction of breast cancer metastasis on clinical data using machine learning algorithms,” <em>Scientific Reports</em>, vol.&nbsp;13, no.&nbsp;1, p.&nbsp;485, January 2023.</li>
            <li>Burak Yagin, Ozkan Aydogdu, Ali Sahin Tas, et al., “Cancer metastasis prediction and genomic biomarker identification through machine learning and explainable artificial intelligence in breast cancer research,” <em>Diagnostics</em>, vol.&nbsp;13, no.&nbsp;21, p.&nbsp;3314, October 2023.</li>
            <li>Hao Duan, Yiming Zhang, Qian Zhang, et al., “Machine learning-based prediction model for distant metastasis of breast cancer,” <em>Computers in Biology and Medicine</em>, vol.&nbsp;169, p.&nbsp;107943, January 2024.</li>
            <li>Azadeh Talebi, Reza Iranpour, Mehdi Dehghani, et al., “Predicting metastasis in gastric cancer patients: machine learning-based approaches,” <em>Scientific Reports</em>, vol.&nbsp;13, no.&nbsp;1, p.&nbsp;4163, December 2023.</li>
            <li>Reza Talebi, Azadeh Talebi, Reza Iranpour, et al., “Machine learning-based classifiers to predict metastasis in colorectal cancer patients,” <em>Frontiers in Artificial Intelligence</em>, vol.&nbsp;7, p.&nbsp;1285037, January 2024.</li>
            <li>Oluwaseun O. Petinrin, Hemanth N. Kandala, Oluwatoyin M. Oyeleye, and Halimat B. Oyedotun, “Machine learning in metastatic cancer research: potentials, possibilities, and prospects,” <em>Computational and Structural Biotechnology Journal</em>, vol.&nbsp;21, pp.&nbsp;2454–2470, March 2023.</li>
            <li>Sarah Albaradei, Turki Turki, and Mansour Aldawsari, “Machine learning and deep learning methods that use omics data for metastasis prediction,” <em>Computational and Structural Biotechnology Journal</em>, vol.&nbsp;19, pp.&nbsp;5008–5018, September 2021.</li>
            <li>Jianjing Gao, Benjamin A. Hendrickson, Kenneth W. Kinzler, et al., “Integrative analysis of complex cancer genomics and clinical profiles using the cBioPortal,” <em>Science Signaling</em>, vol.&nbsp;6, no.&nbsp;269, p.&nbsp;pl1, 2013.</li>
            <li>Martin Rudin and Ralph Weissleder, “Molecular imaging in drug discovery and development,” <em>Nature Reviews Drug Discovery</em>, vol.&nbsp;2, no.&nbsp;2, pp.&nbsp;123–131, February 2003.</li>
            <li>The Broad Institute, “MSigDB: Molecular Signatures Database,” Available: <a href="https://www.gsea-msigdb.org/gsea/msigdb/human/collections.jsp">https://www.gsea-msigdb.org/gsea/msigdb/human/collections.jsp</a> (accessed 13 June 2025).</li>
            <li>Debraj Sengupta and Guillaume Pratx, “Imaging metabolic heterogeneity in cancer,” <em>Molecular Cancer</em>, vol.&nbsp;15, article 4, 2016.</li>
            <li>Benjamin Nguyen, Jiayin Cheng, Yiqun Zhou, et al., “Genomic characterization of metastatic patterns from prospective clinical sequencing of 25 000 patients,” <em>Cell</em>, vol.&nbsp;185, no.&nbsp;3, pp.&nbsp;563–575.e11, February 2022.</li>
            <li>Yu Sun, Zhaokai Zhang, Xin Liang, et al., “Integrated multi-omics profiling to dissect the spatiotemporal evolution of metastatic hepatocellular carcinoma,” <em>Cancer Cell</em>, vol.&nbsp;42, no.&nbsp;1, pp.&nbsp;135–156.e17, January 2024.</li>
            <li>Xiaoyu Zhang, Kailin Xiao, Yu Wen, et al., “Multi-omics with dynamic network biomarker algorithm prefigures organ-specific metastasis of lung adenocarcinoma,” <em>Nature Communications</em>, vol.&nbsp;15, article 9855, 2024.</li>
            <li>Cristina Caballero, Anne Irrthum, Theano Goulioti, et al., “International research to address the challenges of metastatic breast cancer: the AURORA Program (BIG 14-01),” <em>NPJ Breast Cancer</em>, vol.&nbsp;9, article 42, 2023.</li>
            <li>Michael L. Ludwig, Dana Moline, Alexander Horrmann, et al., “Integrated multi-omics assessment of lineage plasticity in a prostate cancer patient with brain and dural metastases,” <em>NPJ Precision Oncology</em>, vol.&nbsp;8, article 215, 2024.</li>
            <li>Dina Akhoundova, Raffaele Bisperi, Julia Salm, et al., “Clinical application of advanced multi-omics tumor profiling: shaping precision oncology of the future,” <em>Cancer Cell</em>, vol.&nbsp;40, no.&nbsp;9, pp.&nbsp;920–938, September 2022.</li>
            <li>Jinzhou Zhou, Xia Lu, Wei Chang, Chunlei Wan, Xianjun Lu, Changju Zhang, and Shanshan Cao, “PLUS: Predicting cancer metastasis potential based on positive and unlabeled learning,” <em>PLOS Computational Biology</em>, vol.&nbsp;18, no.&nbsp;3, e1009956, March 2022.</li>
          </ol>

        </div><!-- /.content -->
      </div><!-- /.column -->
    </div><!-- /.columns -->
  </div><!-- /.container -->
</section>
<!-- Proposal -->


<!-- Image Carousel
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
       <div class="item">
        <img src="static/images/carousel1.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          First image description.
        </h2>
      </div>
      <div class="item">
        <img src="static/images/carousel2.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Second image description.
        </h2>
      </div>
      <div class="item">
        <img src="static/images/carousel3.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
         Third image description.
       </h2>
     </div>
     <div class="item">
      <img src="static/images/carousel4.jpg" alt="MY ALT TEXT"/>
      <h2 class="subtitle has-text-centered">
        Fourth image description.
      </h2>
    </div>
  </div>
</div>
</div>
</section>
  -->



<!-- Youtube video-->
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Video Presentation</h2>
      <div class="columns is-centered has-text-centered">
        <div class="column is-five-fifths">
          
          <div class="publication-video">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/rjIGw3sAy2U?si=PmD0c-G4DrdtPhSk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<!-- Video carousel
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Another Carousel</h2>
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-video1">
          <video poster="" id="video1" autoplay controls muted loop height="100%">
            <source src="static/videos/carousel1.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video2">
          <video poster="" id="video2" autoplay controls muted loop height="100%">
            <source src="static/videos/carousel2.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video3">
          <video poster="" id="video3" autoplay controls muted loop height="100%">\
            <source src="static/videos/carousel3.mp4"
            type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>
-->






<!-- Paper poster
<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/sample.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section>
-->


<!--BibTex citation
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>BibTex Code Here</code></pre>
    </div>
</section>
-->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
